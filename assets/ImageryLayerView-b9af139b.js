import{aQ as r,aR as p,d2 as g,aT as x,aA as c,ca as E,cd as m}from"./index-383689b1.js";import{p as b}from"./popupUtils-98519cca.js";const D=y=>{let e=class extends y{constructor(){super(...arguments),this.view=null}async fetchPopupFeatures(t,n){const{layer:a}=this;if(!t)throw new c("imagerylayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:a});const{popupEnabled:u}=a,o=b(a,n);if(!u||o==null)throw new c("imagerylayerview:fetchPopupFeatures","Missing required popupTemplate or popupEnabled",{popupEnabled:u,popupTemplate:o});const d=await o.getRequiredFields(),s=new E;s.timeExtent=this.timeExtent,s.geometry=t,s.outFields=d,s.outSpatialReference=t.spatialReference;const{resolution:i,spatialReference:l}=this.view,w=this.view.type==="2d"?new m(i,i,l):new m(.5*i,.5*i,l),{returnTopmostRaster:h,showNoDataRecords:R}=o.layerOptions||{returnTopmostRaster:!0,showNoDataRecords:!1},f={returnDomainValues:!0,returnTopmostRaster:h,pixelSize:w,showNoDataRecords:R,signal:n!=null?n.signal:null};return a.queryVisibleRasters(s,f).then(v=>v)}canResume(){var t;return!!super.canResume()&&!((t=this.timeExtent)!=null&&t.isEmpty)}};return r([p()],e.prototype,"layer",void 0),r([p()],e.prototype,"suspended",void 0),r([p(g)],e.prototype,"timeExtent",void 0),r([p()],e.prototype,"view",void 0),e=r([x("esri.views.layers.ImageryLayerView")],e),e};export{D as n};
